<!DOCTYPE html>
<html>
<head>
<link href='./fullcalendar-1.6.4/fullcalendar-custom/fullcalendar.css' rel='stylesheet' />
<link href='./fullcalendar-1.6.4/fullcalendar-custom/fullcalendar.print.css' rel='stylesheet' media='print' />
<link rel="stylesheet" href="./qunit/css/qunit-1.14.0.css">
<!-- <script src='./fullcalendar-1.6.4/lib/jquery.min.js'></script> -->
<script type="text/javascript" src="./jquery/jquery-1.10.2.min.js"></script>
<script src="./qunit/js/qunit-1.14.0.js"></script>
<script src="./jnotify/js/jNotify.jquery.js"></script>
<!-- <script src="./json/json3.min.js"></script> -->
<script src="./ajax/ajax.js"></script>
<script src='./fullcalendar-1.6.4/lib/jquery-ui.custom.min.js'></script>
<script src='./fullcalendar-1.6.4/fullcalendar-custom/fullcalendar.min.js'></script>
<script>
	$(document).ready(function() {
// 		var date = new Date();
// 		var d = date.getDate();
// 		var m = date.getMonth();
// 		var y = date.getFullYear();
		
		var calendar = $('#calendar').fullCalendar({
			header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month' // 'month,agendaWeek,agendaDay'
			},
			selectable: true,
			selectHelper: true,
			select: function(start, end, allDay) {
// 				var title = prompt('일정 이름:');
// 				if (title) {
// 					calendar.fullCalendar('renderEvent',
// 						{
// 							title: title,
// 							start: start,
// 							end: end,
// 							allDay: allDay
// 						},
// 						true // make the event "stick"
// 					);
// 				}
// 				calendar.fullCalendar('unselect');
			},
			editable: false
// 			,events: [
// 				{
// 					title: '하루종일 일정',
// 					start: new Date(y, m, 1)
// 				},
// 				{
// 					title: '장시간 체류',
// 					start: new Date(y, m, d-5),
// 					end: new Date(y, m, d-2)
// 				},
// 				{
// 					id: 999,
// 					title: '반복',
// 					start: new Date(y, m, d-3, 16, 0),
// 					allDay: false
// 				},
// 				{
// 					id: 999,
// 					title: '반복',
// 					start: new Date(y, m, d+4, 16, 0),
// 					allDay: false
// 				},
// 				{
// 					title: '회의',
// 					start: new Date(y, m, d, 10, 30),
// 					allDay: false
// 				},
// 				{
// 					title: '점심약속',
// 					start: new Date(y, m, d, 12, 0),
// 					end: new Date(y, m, d, 14, 0),
// 					allDay: false
// 				},
// 				{
// 					title: '생일파티',
// 					start: new Date(y, m, d+1, 19, 0),
// 					end: new Date(y, m, d+1, 22, 30),
// 					allDay: false
// 				},
// 				{
// 					title: '구글 캘린더 가기',
// 					start: new Date(y, m, 28),
// 					end: new Date(y, m, 29),
// 					url: 'http://google.com/'
// 				}
// 			]
		});
		
		var result = callAjax(null, 'plan.json', null, 'get', 'json');
		
		setTimeout(function() {
			test("fullCalendar test : json ", function() {
				equal(result.status, "200", "json Passed");
				
				var planList = result.responseJSON;
				for(var jsonArrayKey in planList){
					
					equal(typeof jsonArrayKey, "string", "1depth key type is string >> " + jsonArrayKey);
					
					for(var index in $(planList).attr(jsonArrayKey)){
						
						equal(typeof index, "string", "2depth key type is string >> " + index);
						
						var id;
						var title;
						var start;
						var end;
						var allDay;
						var url;

						var value;
						
						var jsonString = $(planList).attr(jsonArrayKey)[index];
						for(var key in jsonString){
						
							equal(typeof key, "string", "3depth key type is string >> " + key + " : " + $(jsonString).attr(key));
							
							value = $(jsonString).attr(key);
							
							switch(key){
							case "id" :
								id = value;
								break;
							case "title" :
								title = value;
								break;
							case "start" :
								var yyyy = value.substr(0,4);
								var mm = (value.substr(4,2) * 1) - 1;
								var dd = value.substr(6);
								start = new Date(yyyy, mm, dd);
								break;
							case "end" :
								var yyyy = value.substr(0,4);
								var mm = (value.substr(4,2) *1) - 1;
								var dd = value.substr(6);
								end = new Date(yyyy, mm, dd);
								break;
							case "allDay" :
								allDay = value;
								break;
							case "url" :
								url = value;
								break;	
							}
						
						}
						
						calendar.fullCalendar('renderEvent', {
							id: id,
							title: title,
							start: start,
							end: end,
// 							url: url,
							allDay: allDay
						}, true);
						
					}
					
				}
				
			});
		}, 500);		
		
	});

</script>
<style>

	body {
		margin-top: 40px;
		text-align: center;
		font-size: 14px;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
	}

	#calendar {
		width: 900px;
/* 		height: 310px; */
		margin: 0 auto;
	}
	
	.qunit {
/* 		width: 900px; */
		text-align: left;
	}	

</style>
</head>
<body>
<div id="qunit" class="qunit"></div>
<div id="qunit-fixture" class="qunit"></div>
<div id='calendar'></div>
</body>
</html>
